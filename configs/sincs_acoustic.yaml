# SINCS Training Config for Acoustic Scattering Dataset
# Optimized for Cerebras CSX

trainer:
  init:
    seed: 42
    model_dir: sincs_acoustic_model
    backend:
      backend_type: CSX
      cluster_config:
        num_workers_per_csx: 1
        mount_dirs:
          - /cra-1272/PhysicsAlchemists/datasets
          - /cra-1272/PhysicsAlchemists/WellImplementation/modelzoo/src
        python_paths:
          - /cra-1272/PhysicsAlchemists/WellImplementation/modelzoo/src
    model:
      name: sincs
      input_dim: 3
      output_dim: 1
      hidden_dim: 256
      num_hidden_layers: 4
      omega_0: 30.0
      omega_hidden: 30.0
      use_fourier_encoding: true
      encoding_levels: 10
      dropout: 0.0
      loss_type: mse
      to_float16: true
    optimizer:
      Adam:
        lr: 0.001
        betas: [0.9, 0.999]
        eps: 1.0e-08
        weight_decay: 0.0
    schedulers:
    - SequentialLR:
        schedulers:
        - LinearLR:
            initial_learning_rate: 0.0
            end_learning_rate: 0.001
            total_iters: 1000
        - CosineDecayLR:
            initial_learning_rate: 0.001
            end_learning_rate: 0.0001
            total_iters: 19000
    precision:
      enabled: true
      fp16_type: bfloat16
      loss_scaling_factor: 1.0
      max_gradient_norm: 1.0
    loop:
      max_steps: 20000
    checkpoint:
      steps: 5000
    logging:
      log_steps: 100
  fit:
    train_dataloader:
      data_processor: SINCSDataProcessor
      data_dir: /cra-1272/PhysicsAlchemists/datasets
      dataset_name: acoustic_scattering_discontinuous
      trajectory_idx: 0
      num_timesteps: 50
      batch_size: 16384
      num_samples_per_epoch: 500000
      shuffle: true
      shuffle_seed: 42
      num_workers: 0
      prefetch_factor: 2
      persistent_workers: false
      drop_last: true
      use_fake_data: false
